services:
  # ----------------------------------------------------------------
  # ğŸ˜ Database (Dev Override)
  # ----------------------------------------------------------------
  db:
    ports:
      # 127.0.0.1 ã‚’æŒ‡å®šã—ã¦ã€å¤–éƒ¨LANã‹ã‚‰ã®æ¥ç¶šã‚’é®æ–­
      - "127.0.0.1:5432:5432"

  # ----------------------------------------------------------------
  # ğŸ Backend (Dev Override)
  # ----------------------------------------------------------------
  backend:
    ports:
      # Swagger UIç­‰ã‚‚è‡ªåˆ†ã ã‘ãŒè¦‹ã‚Œã‚‹ã‚ˆã†ã«åˆ¶é™
      - "127.0.0.1:8000:8000"
    volumes:
      - ./backend:/app
    environment:
      ENV: dev
      LOG_LEVEL: debug
      GEMINI_API_KEY: ${GEMINI_API_KEY}
      LLM_PROVIDER: ${LLM_PROVIDER}
    command: uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
    extra_hosts:
      - "host.docker.internal:host-gateway"

  # ----------------------------------------------------------------
  # âš›ï¸ Frontend (Dev Override)
  # ----------------------------------------------------------------
  frontend:
    ports:
      # ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚‚è‡ªåˆ†ã®ã¿
      - "127.0.0.1:3000:5173"
    volumes:
      - ./frontend:/app
      - /app/node_modules
    environment:
      - CHOKIDAR_USEPOLLING=true
      - NODE_ENV=development
    command: npm run dev -- --host

  # ----------------------------------------------------------------
  # ğŸŒ Nginx (Dev Override)
  # ----------------------------------------------------------------
  # ãƒ™ãƒ¼ã‚¹(compose.yaml)ã§é–‹ã‘ã¦ã„ã‚‹80ç•ªãƒãƒ¼ãƒˆã‚‚ã€
  # é–‹ç™ºæ™‚ã¯è‡ªåˆ†å°‚ç”¨ã«ã™ã‚‹ãŸã‚ã«ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ã—ã¾ã™ã€‚
  nginx:
      ports:
        - "127.0.0.1:80:80"