# ----------------------------------------------------------------
# 1. Base Image
# ----------------------------------------------------------------
# Node.js 20 (LTS) の軽量版を使用
FROM node:24-slim

# 作業ディレクトリ
WORKDIR /app

# ----------------------------------------------------------------
# 2. Dependencies
# ----------------------------------------------------------------
# package.json (とあればlockファイル) を先にコピー
COPY package.json package-lock.json* ./

# 依存関係のインストール
# --legacy-peer-deps: 互換性エラーを無視してインストール（開発初期は安定重視）
RUN npm install --legacy-peer-deps

# ----------------------------------------------------------------
# 3. Runtime
# ----------------------------------------------------------------
# ソースコードをコピー
COPY . .

# 開発サーバー起動
# --host: コンテナ外からアクセス可能にする必須フラグ
CMD ["npm", "run", "dev", "--", "--host"]